# üêÜ Leopard Challenge: —Ä–µ–≥—Ä–µ—Å—Å–∏—è —Ü–µ–Ω –Ω–∞ –∂–∏–ª—å—ë –≤ –ú–µ–ª—å–±—É—Ä–Ω–µ

> –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ –ø–æ –¥–∞–Ω–Ω—ã–º –æ —Ä–∞–π–æ–Ω–µ, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞—Ö –¥–æ–º–∞ –∏ –¥–∞—Ç–µ –ø—Ä–æ–¥–∞–∂–∏  


[üìì Jupyter Notebook](notebook/regression-leopard-challenge.ipynb)

[![Kaggle](https://img.shields.io/badge/Kaggle-leopard--challenge--regression-20BEFF?style=flat&logo=kaggle)](https://www.kaggle.com/competitions/leopard-challenge-regression)
![CatBoost](https://img.shields.io/badge/CatBoost-Regressor-FFCC00?style=flat)
![Python](https://img.shields.io/badge/Python-3776AB?style=flat&logo=python&logoColor=white)
![Jupyter](https://img.shields.io/badge/Jupyter-Notebook-F37626?style=flat&logo=jupyter)
![Pandas](https://img.shields.io/badge/Pandas-Data%20Analysis-150458?style=flat&logo=pandas)
![NumPy](https://img.shields.io/badge/NumPy-Numerical-013243?style=flat&logo=numpy)
![Matplotlib](https://img.shields.io/badge/Matplotlib-Visualization-11557C?style=flat)
![Seaborn](https://img.shields.io/badge/Seaborn-Visualization-4C8CBF?style=flat)
![scikit-learn](https://img.shields.io/badge/scikit--learn-ML-FA6F00?style=flat&logo=scikit-learn)
![Optuna](https://img.shields.io/badge/Optuna-Hyperparameter--Tuning-7A1FA2?style=flat)
![Phik](https://img.shields.io/badge/Phik-Correlation-0A7BBB?style=flat)

---

## üîç –û–±–∑–æ—Ä

–ü—Ä–æ–µ–∫—Ç —Ä–µ—à–∞–µ—Ç –∑–∞–¥–∞—á—É **—Ä–µ–≥—Ä–µ—Å—Å–∏–∏**: –ø–æ –¥–∞–Ω–Ω—ã–º –æ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ –≤ –ú–µ–ª—å–±—É—Ä–Ω–µ –Ω—É–∂–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å —Ü–µ–Ω—É –æ–±—ä–µ–∫—Ç–∞ `Price`.

–î–∞–Ω–Ω—ã–µ –≤–∫–ª—é—á–∞—é—Ç:
- –ª–æ–∫–∞—Ü–∏—é (`Suburb`, `Postcode`, `Regionname`, `Distance` –¥–æ —Ü–µ–Ω—Ç—Ä–∞),
- —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –¥–æ–º–∞ (`Rooms`, `Bathroom`, `Car`, `BuildingArea`, `Landsize`, `YearBuilt`),
- –¥–∞–Ω–Ω—ã–µ –æ –¥–∞—Ç–µ –ø—Ä–æ–¥–∞–∂–∏ (`Date`, –¥–∞–ª–µ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–Ω–∞—è –Ω–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏),
- –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é (`CouncilArea`, `Propertycount` –∏ –¥—Ä.).

–î–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **CatBoostRegressor**, –∫–æ—Ç–æ—Ä—ã–π —É–º–µ–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ ‚Äú–∏–∑ –∫–æ—Ä–æ–±–∫–∏‚Äù –∏ —É—Å—Ç–æ–π—á–∏–≤ –∫ –ø—Ä–æ–ø—É—Å–∫–∞–º.

---

## üéØ –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏

**–¢–∏–ø –∑–∞–¥–∞—á–∏:** —Ä–µ–≥—Ä–µ—Å—Å–∏—è  
**–¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è:** `Price` ‚Äî —Å—Ç–æ–∏–º–æ—Å—Ç—å –æ–±—ä–µ–∫—Ç–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏  

–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞:

1. –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ (–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏, —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª–µ–∑–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏).
2. –û–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å, –¥–∞—é—â—É—é —É—Å—Ç–æ–π—á–∏–≤—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å—Ç–æ–∏–º–æ—Å—Ç–∏.
3. –û—Ü–µ–Ω–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç—Ä–∏–∫:
   - –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏ **R¬≤**,
   - **MAPE** (mean absolute percentage error).

---

## üßæ –î–∞–Ω–Ω—ã–µ

–û—Å–Ω–æ–≤–Ω–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç (`train.csv`) —Å–æ–¥–µ—Ä–∂–∏—Ç:

- **18373 —Å—Ç—Ä–æ–∫** –∏ **22 —Å—Ç–æ–ª–±—Ü–∞**  
- –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏: `Suburb`, `Address`, `Type`, `Method`, `SellerG`, `CouncilArea`, `Regionname`
- —á–∏—Å–ª–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏: `Rooms`, `Distance`, `Postcode`, `Bedroom2`, `Bathroom`, `Car`, `Landsize`, `BuildingArea`, `YearBuilt`, `Lattitude`, `Longtitude`, `Propertycount`, –∞ —Ç–∞–∫–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏

–¢–µ—Å—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä (`test.csv`) –∏–º–µ–µ—Ç —Ç—É –∂–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –Ω–æ –±–µ–∑ `Price` ‚Äî –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Å–∞–±–º–∏—Ç–∞ –Ω–∞ Kaggle.

---

## üßπ –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ feature engineering

–í—Å–µ –∫–ª—é—á–µ–≤—ã–µ —à–∞–≥–∏ —Å–æ–±—Ä–∞–Ω—ã –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `preprocess(df)` –≤–Ω—É—Ç—Ä–∏ –Ω–æ—É—Ç–±—É–∫–∞.

### 1. –†–∞–±–æ—Ç–∞ —Å –¥–∞—Ç–æ–π

–°—Ç–æ–ª–±–µ—Ü `Date` –ø—Ä–∏–≤–æ–¥–∏—Ç—Å—è –∫ —Ç–∏–ø—É `datetime`, –∑–∞—Ç–µ–º –∏–∑ –Ω–µ–≥–æ –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è:

- `year`
- `month`
- `day`
- `dayofweek`
- `is_weekend` (–≤—ã—Ö–æ–¥–Ω–æ–π –∏–ª–∏ –Ω–µ—Ç)
- `quarter`
- `weekofyear`

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∏—Å—Ö–æ–¥–Ω—ã–π `Date` —É–¥–∞–ª—è–µ—Ç—Å—è.

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –ª–æ–≥–∏–∫–∞, –∞ –Ω–µ ¬´—Ç—É–ø–æ–µ¬ª –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–∏–º:

- `BuildingArea` ‚Äî –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –º–µ–¥–∏–∞–Ω–æ–π –ø–æ –≥—Ä—É–ø–ø–∞–º `[Type, Rooms]`, –∑–∞—Ç–µ–º –ø–æ `Type`.
- `YearBuilt` ‚Äî —Å–Ω–∞—á–∞–ª–∞ –º–µ–¥–∏–∞–Ω–∞ –≤–Ω—É—Ç—Ä–∏ `Suburb`, –∑–∞—Ç–µ–º –≥–ª–æ–±–∞–ª—å–Ω–∞—è –º–µ–¥–∏–∞–Ω–∞.
- `Bedroom2`, `Bathroom`, `Car`, `Landsize`, `Propertycount` ‚Äî –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –º–µ–¥–∏–∞–Ω–∞–º–∏ (–∏–Ω–æ–≥–¥–∞ –ø–æ –≥—Ä—É–ø–ø–∞–º, –∏–Ω–æ–≥–¥–∞ –≥–ª–æ–±–∞–ª—å–Ω–æ).
- `Lattitude` –∏ `Longtitude`:
  - —Å—Ä–µ–¥–Ω–µ–µ –ø–æ –≥—Ä—É–ø–ø–∞–º `['Suburb', 'Postcode']`,
  - –∑–∞—Ç–µ–º –ø–æ `Suburb`,
  - –∑–∞—Ç–µ–º –ø–æ `Distance`,
  - –æ—Å—Ç–∞—Ç–æ–∫ ‚Äî –≥–ª–æ–±–∞–ª—å–Ω—ã–º —Å—Ä–µ–¥–Ω–∏–º.
- `CouncilArea`, `Regionname` ‚Äî –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è —Å—Ç—Ä–æ–∫–æ–π `'missing'` –∏ –ø—Ä–∏–≤–æ–¥—è—Ç—Å—è –∫ —Å—Ç—Ä–æ–∫–æ–≤–æ–º—É —Ç–∏–ø—É.

–¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ä—ã–Ω–∫–∞: –ø–æ—Ö–æ–∂–∏–µ –¥–æ–º–∞ –≤ –æ–¥–Ω–æ–º —Ä–∞–π–æ–Ω–µ –ø–æ–ª—É—á–∞—é—Ç –±–æ–ª–µ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.

### 3. –í—ã–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ —Ñ–∏—á–∏

–ú–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∏–∑–Ω–∞–∫–∏:

```python
X = [
    'Suburb', 'Rooms', 'Method', 'Type', 'SellerG',
    'Distance', 'Postcode', 'Bedroom2', 'Bathroom', 'Car',
    'CouncilArea', 'Regionname', 'Landsize', 'BuildingArea',
    'YearBuilt', 'Lattitude', 'Longtitude', 'Propertycount',
    'year', 'month', 'day', 'dayofweek', 'quarter', 'weekofyear'
]

y = 'Price'

cat_features = ['Suburb', 'Method', 'Type', 'SellerG', 'CouncilArea', 'Regionname']
```

–ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ CatBoostRegressor —á–µ—Ä–µ–∑ cat_features.

---

## ü§ñ –ú–æ–¥–µ–ª—å –∏ –æ–±—É—á–µ–Ω–∏–µ

### –ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `CatBoostRegressor` —Å —Ñ—É–Ω–∫—Ü–∏–µ–π –ø–æ—Ç–µ—Ä—å **RMSE** –∏ –º–µ—Ç—Ä–∏–∫–æ–π –∫–∞—á–µ—Å—Ç–≤–∞ **MAPE**.  
–û–±—É—á–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å —Ä–∞–∑–±–∏–µ–Ω–∏–µ–º –Ω–∞ `train/val` (—á–µ—Ä–µ–∑ `train_test_split`) –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º GPU (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏):

- –±–æ–ª—å—à–æ–µ —á–∏—Å–ª–æ –∏—Ç–µ—Ä–∞—Ü–∏–π;
- `bootstrap_type = 'Bayesian'`;
- –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–ª—É–±–∏–Ω—ã –¥–µ—Ä–µ–≤–∞, `l2_leaf_reg`, `bagging_temperature`;
- `early_stopping_rounds` –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è.

### –ü–æ–¥–±–æ—Ä –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–î–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **Optuna**:

- –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É—é—Ç—Å—è:
  - `learning_rate`
  - `depth`
  - `l2_leaf_reg`
  - `bagging_temperature`
  - `random_strength`
  - `early_stopping_rounds`
- —Ü–µ–ª–µ–≤–∞—è –º–µ—Ç—Ä–∏–∫–∞ –≤ Optuna: `neg_mean_absolute_percentage_error`  
  —Å –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–µ–π (`cross_val_score`, `cv=2`).

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–æ–∏—Å–∫–∞ –º–æ–¥–µ–ª—å –¥–æ–æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ –ø–æ–ª–Ω–æ–º —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ —Å –ª—É—á—à–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.

---

üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ò—Ç–æ–≥–æ–≤–∞—è –º–æ–¥–µ–ª—å –Ω–∞ –ø–æ–ª–Ω–æ–º —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–º –Ω–∞–±–æ—Ä–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:

R¬≤ (train)	0.954
MAPE (train)	‚âà 8.99%

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º–æ–¥–µ–ª—å —Ö–æ—Ä–æ—à–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –≤–∞—Ä–∏–∞—Ü–∏—é —Ü–µ–Ω –Ω–∞ –∂–∏–ª—å—ë –∏ –≤ —Å—Ä–µ–¥–Ω–µ–º –æ—à–∏–±–∞–µ—Ç—Å—è –º–µ–Ω–µ–µ —á–µ–º –Ω–∞ 9 %.

MAPE (test) Kaggle = 15.13012

---

üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```bash
.
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ sample_submission.csv
‚îÇ   ‚îú‚îÄ‚îÄ test.csv
‚îÇ   ‚îî‚îÄ‚îÄ train.csv
‚îú‚îÄ‚îÄ notebook/
‚îÇ   ‚îî‚îÄ‚îÄ regression-leopard-challenge.ipynb
‚îú‚îÄ‚îÄ LICENSE
‚îî‚îÄ‚îÄ README.md
```
---

üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å
1.	–ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```bash
git clone https://github.com/<username>/leopard-challenge-regression.git
cd leopard-challenge-regression
```

2.	–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements.txt
```
requirements.txt:

```bash
pandas
numpy
matplotlib
seaborn
scikit-learn
catboost
optuna
phik
```
3.	–û—Ç–∫—Ä—ã—Ç—å –Ω–æ—É—Ç–±—É–∫:
```bash
jupyter notebook regression-leopard-challenge.ipynb
```
4.	–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —è—á–µ–π–∫–∏:
	‚Ä¢	–∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö,
	‚Ä¢	–ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ preprocess(df),
	‚Ä¢	–æ–±—É—á–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–π –º–æ–¥–µ–ª–∏,
	‚Ä¢	–∑–∞–ø—É—Å–∫ Optuna –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤,
	‚Ä¢	–≥–µ–Ω–µ—Ä–∞—Ü–∏—è submission.csv –¥–ª—è Kaggle.

---

##  –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏

- –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≥—Ä—É–ø–ø–∏—Ä–æ–≤–æ–∫ (`groupby` + `median/mean`);
- –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–∑ –¥–∞—Ç—ã –ø—Ä–æ–¥–∞–∂–∏;
- —Ä–∞–±–æ—Ç–∞ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ —á–µ—Ä–µ–∑ CatBoost –±–µ–∑ —è–≤–Ω–æ–≥–æ one-hot;
- –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —á–µ—Ä–µ–∑ Optuna;
- –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º R¬≤ –∏ MAPE.

